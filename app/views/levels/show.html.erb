<div class="card">
  <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 20px;">
    <div>
      <h2 style="color: <%= @level_info[:color] %>; margin-bottom: 10px;">
        Level <%= @level_number %>: <%= @level_info[:name] %>
      </h2>
      <p style="font-size: 22px; color: <%= @level_info[:color] %>; margin-bottom: 15px;">
        <%= @progress[:completed] %> / <%= @progress[:total] %> lessons completed
      </p>
    </div>
    <%= link_to "← Back to Levels", levels_path, class: "btn btn-secondary" %>
  </div>
  
  <div class="progress-bar" style="margin-bottom: 25px;">
    <div class="progress-fill" style="width: <%= @progress[:percentage] %>%">
      <%= @progress[:percentage] %>%
    </div>
  </div>
  
  <div class="examples" style="background: <%= @level_info[:light_color] %>; border-left: 6px solid <%= @level_info[:color] %>; padding: 25px; margin-bottom: 25px;">
    <h3 style="color: <%= @level_info[:color] %>; margin-bottom: 15px; font-size: 28px;">Learning Objectives</h3>
    <ul style="font-size: 22px; line-height: 1.8; color: <%= @level_info[:color] %>;">
      <% @level_info[:objectives].each do |objective| %>
        <li style="margin: 10px 0;"><strong><%= objective.split(' - ').first %></strong><% if objective.include?(' - ') %> - <%= objective.split(' - ').last %><% end %></li>
      <% end %>
    </ul>
    
    <h3 style="color: <%= @level_info[:color] %>; margin-top: 25px; margin-bottom: 15px; font-size: 26px;">Language Learning Approach</h3>
    <p style="font-size: 20px; line-height: 1.8; color: <%= @level_info[:color] %>;">
      <%= @level_info[:approach] %>
    </p>
  </div>
  
  <h3 style="color: <%= @level_info[:color] %>; margin-bottom: 20px; font-size: 32px;">Lessons</h3>
  <div class="lesson-list">
    <% @lessons.each do |lesson| %>
      <% progress = @user.lesson_progresses.find_by(lesson: lesson) %>
      <% previous_lesson = lesson.previous_lesson %>
      <% is_locked = !lesson.first_lesson? && (!previous_lesson || !@user.lesson_progresses.find_by(lesson: previous_lesson)&.completed?) %>
      
      <div class="lesson-card <%= 'completed' if progress&.completed? %> <%= 'locked' if is_locked %>" style="<%= 'opacity: 0.6;' if is_locked %>">
        <h4 style="margin-bottom: 10px; font-size: 22px;">
          Lesson <%= lesson.order %>: <%= lesson.title %>
          <% if progress&.completed? %>
            <span style="color: <%= @level_info[:color] %>; text-shadow: 0 0 10px <%= @level_info[:color] %>;">✓</span>
          <% end %>
        </h4>
        <% if progress&.completed? %>
          <p style="color: <%= @level_info[:color] %>; font-size: 18px;">Completed! +<%= progress.points_earned %> points</p>
        <% elsif is_locked %>
          <p style="color: <%= @level_info[:color] %>; font-size: 18px; opacity: 0.6;">Locked</p>
        <% else %>
          <p style="color: <%= @level_info[:color] %>; font-size: 18px;">Ready to learn!</p>
        <% end %>
        <% unless is_locked %>
          <%= link_to "Start Lesson", lesson_path(lesson.order), class: "btn", style: "margin-top: 10px; width: 100%; text-align: center; font-size: 20px; border-color: #{@level_info[:color]};" %>
        <% end %>
      </div>
    <% end %>
  </div>
</div>
